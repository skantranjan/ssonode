<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
    <title>SharePoint Page Editor</title>
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f3f2f1;
            color: #323130;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Top Navigation Bar */
        .top-nav {
            background: white;
            border-bottom: 1px solid #e1dfdd;
            padding: 0 20px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .site-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: #323130;
        }

        .site-icon {
            width: 20px;
            height: 20px;
            background: #0078d4;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        .page-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn {
            background: transparent;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: #323130;
            transition: background 0.2s ease;
        }

        .nav-btn:hover {
            background: #f3f2f1;
        }

        .nav-btn.primary {
            background: #6264a7;
            color: white;
        }

        .nav-btn.primary:hover {
            background: #585ac6;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-profile {
            width: 32px;
            height: 32px;
            background: #0078d4;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        /* Main Layout */
        .main-layout {
            display: flex;
            margin-top: 60px;
            min-height: calc(100vh - 60px);
        }

        /* Main Content Area */
        .main-content {
            flex: 1;
            background: white;
            padding: 0;
            position: relative;
        }

        /* Header/Banner Area */
        .page-header-placeholder {
            height: 200px;
            background: linear-gradient(45deg, #f3f2f1 25%, transparent 25%), 
                        linear-gradient(-45deg, #f3f2f1 25%, transparent 25%), 
                        linear-gradient(45deg, transparent 75%, #f3f2f1 75%), 
                        linear-gradient(-45deg, transparent 75%, #f3f2f1 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-header-placeholder:hover {
            background: linear-gradient(45deg, #e1dfdd 25%, transparent 25%), 
                        linear-gradient(-45deg, #e1dfdd 25%, transparent 25%), 
                        linear-gradient(45deg, transparent 75%, #e1dfdd 75%), 
                        linear-gradient(-45deg, transparent 75%, #e1dfdd 75%);
        }

        .page-header-placeholder.has-image {
            background: none !important;
            background-size: cover !important;
            background-position: center !important;
            background-repeat: no-repeat !important;
        }

        .page-header-placeholder::after {
            content: "Click to add header image";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #605e5c;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.9);
            padding: 12px 20px;
            border-radius: 6px;
            border: 2px dashed #0078d4;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-header-placeholder:hover::after {
            background: rgba(255, 255, 255, 1);
            border-color: #106ebe;
            color: #0078d4;
        }

        .page-header-placeholder.has-image::after {
            content: "Click to change header image";
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .page-header-placeholder.has-image:hover::after {
            background: rgba(0, 0, 0, 0.8);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .header-image-remove {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .page-header-placeholder.has-image .header-image-remove {
            display: flex;
        }

        .header-image-remove:hover {
            background: rgba(209, 52, 56, 0.9);
        }

        /* Page Content Area */
        .page-content-area {
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }

        .page-title-section {
            margin-bottom: 20px;
        }

        .page-title-input {
            font-size: 2.5rem;
            font-weight: 300;
            color: #323130;
            border: none;
            outline: none;
            width: 100%;
            background: transparent;
            margin-bottom: 10px;
        }

        .page-title-input::placeholder {
            color: #605e5c;
        }

        .author-info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #605e5c;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .author-avatar {
            width: 20px;
            height: 20px;
            background: #0078d4;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 10px;
        }

        /* Content Blocks */
        .content-section {
            margin: 20px 0;
            position: relative;
        }

        .add-section-btn {
            width: 40px;
            height: 40px;
            background: #6264a7;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin: 20px auto;
            transition: all 0.2s ease;
        }

        .add-section-btn:hover {
            background: #585ac6;
            transform: scale(1.1);
        }

        .content-block {
            position: relative;
            margin: 10px 0;
            padding: 20px;
            border: 2px solid transparent;
            border-radius: 4px;
            transition: all 0.2s ease;
            cursor: move;
            background: white;
        }

        .content-block:hover {
            border-color: #0078d4;
            background: #f8f9fa;
        }

        .content-block.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
            z-index: 1000;
        }

        .content-block.drag-over {
            border-color: #0078d4;
            background: #e3f2fd;
        }

        .content-block-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: none;
            gap: 5px;
        }

        .content-block:hover .content-block-controls {
            display: flex;
        }

        .content-control-btn {
            background: #0078d4;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 6px 10px;
            font-size: 12px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .content-control-btn:hover {
            background: #106ebe;
        }

        .content-control-btn.delete {
            background: #d13438;
        }

        .content-control-btn.delete:hover {
            background: #b02a2e;
        }

        .drag-handle {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 24px;
            height: 24px;
            background: #f3f2f1;
            border: 1px solid #e1dfdd;
            border-radius: 3px;
            cursor: move;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #605e5c;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .content-block:hover .drag-handle {
            opacity: 1;
        }

        .content-block.dragging .drag-handle {
            opacity: 1;
        }

        /* Right Sidebar Toolbox */
        .toolbox {
            width: 320px;
            background: white;
            border-left: 1px solid #e1dfdd;
            padding: 20px;
            overflow-y: auto;
            position: fixed;
            right: -320px;
            top: 60px;
            height: calc(100vh - 60px);
            transition: right 0.3s ease;
            z-index: 1000;
        }

        .toolbox.show {
            right: 0;
        }

        .toolbox-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e1dfdd;
        }

        .toolbox-title {
            font-size: 16px;
            font-weight: 600;
            color: #323130;
        }

        .close-toolbox {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: #605e5c;
            padding: 4px;
        }

        .toolbox-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .web-parts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .web-part-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 16px 8px;
            border: 1px solid #e1dfdd;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
        }

        .web-part-option:hover {
            border-color: #0078d4;
            background: #f8f9fa;
        }

        .web-part-icon {
            width: 32px;
            height: 32px;
            background: #f3f2f1;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .web-part-label {
            font-size: 12px;
            color: #323130;
            text-align: center;
        }

        .see-all-link {
            color: #6264a7;
            text-decoration: none;
            font-size: 14px;
            margin-top: 10px;
            display: block;
        }

        .see-all-link:hover {
            text-decoration: underline;
        }

        .stock-images-section {
            margin-top: 20px;
        }

        .stock-search {
            position: relative;
            margin-bottom: 15px;
        }

        .stock-search input {
            width: 100%;
            padding: 8px 12px 8px 35px;
            border: 1px solid #e1dfdd;
            border-radius: 4px;
            font-size: 14px;
        }

        .search-icon {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #605e5c;
        }

        .stock-thumbnails {
            display: flex;
            gap: 8px;
        }

        .stock-thumb {
            width: 60px;
            height: 40px;
            background: linear-gradient(45deg, #0078d4, #6264a7);
            border-radius: 4px;
            cursor: pointer;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px 24px 0 24px;
            border-bottom: 1px solid #e1dfdd;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #323130;
            margin-bottom: 8px;
        }

        .modal-subtitle {
            color: #605e5c;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .modal-body {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #323130;
        }

        .form-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #e1dfdd;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: #0078d4;
            box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .modal-footer {
            padding: 16px 24px 24px 24px;
            border-top: 1px solid #e1dfdd;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .btn-secondary {
            background: #f3f2f1;
            color: #323130;
        }

        .btn-secondary:hover {
            background: #e1dfdd;
        }

        .btn-primary {
            background: #0078d4;
            color: white;
        }

        .btn-primary:hover {
            background: #106ebe;
        }

        /* Quill Editor Styles */
        #editor {
            height: 300px;
            border: 1px solid #e1dfdd;
            border-radius: 4px;
        }

        .ql-toolbar {
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border: 1px solid #e1dfdd;
            border-bottom: none;
            background: #f8f9fa;
        }

        .ql-container {
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            border: 1px solid #e1dfdd;
            border-top: none;
            font-size: 14px;
        }

        /* Table Styles */
        .ql-editor table {
            border-collapse: collapse !important;
            width: 100% !important;
            margin: 10px 0 !important;
            border: 2px solid #000000 !important;
        }

        .ql-editor table td,
        .ql-editor table th {
            border: 2px solid #000000 !important;
            padding: 8px !important;
            min-width: 60px !important;
            position: relative !important;
        }

        .ql-editor table th {
            background-color: #f8f9fa !important;
            font-weight: bold !important;
        }

        /* Editable Table Cell Styles */
        .ql-editor table td.editable {
            cursor: pointer !important;
            transition: background-color 0.2s ease !important;
        }

        .ql-editor table td.editable:hover {
            background-color: #e3f2fd !important;
        }

        .ql-editor table td.editing {
            padding: 0 !important;
            background-color: #fff !important;
        }

        .ql-editor table td.editing input {
            width: 100% !important;
            height: 100% !important;
            border: none !important;
            outline: none !important;
            padding: 8px !important;
            font-size: inherit !important;
            font-family: inherit !important;
            background-color: #fff !important;
            box-sizing: border-box !important;
        }

        .ql-editor table td.editing input:focus {
            background-color: #f8f9fa !important;
            box-shadow: inset 0 0 0 2px #0078d4 !important;
        }

        /* Table Management Styles */
        .ql-editor table {
            position: relative !important;
        }

        .table-controls {
            position: absolute !important;
            top: -40px !important;
            right: 0 !important;
            display: flex !important;
            gap: 5px !important;
            background: white !important;
            border: 1px solid #e1dfdd !important;
            border-radius: 4px !important;
            padding: 5px !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
            z-index: 100 !important;
        }

        .table-control-btn {
            background: #0078d4 !important;
            color: white !important;
            border: none !important;
            border-radius: 3px !important;
            padding: 4px 8px !important;
            font-size: 12px !important;
            cursor: pointer !important;
            transition: background 0.2s ease !important;
        }

        .table-control-btn:hover {
            background: #106ebe !important;
        }

        .table-control-btn.delete {
            background: #d13438 !important;
        }

        .table-control-btn.delete:hover {
            background: #b02a2e !important;
        }

        .table-context-menu {
            position: absolute !important;
            background: white !important;
            border: 1px solid #e1dfdd !important;
            border-radius: 4px !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
            z-index: 1000 !important;
            min-width: 150px !important;
            display: none !important;
        }

        .table-context-menu.show {
            display: block !important;
        }

        .context-menu-item {
            padding: 8px 12px !important;
            cursor: pointer !important;
            font-size: 14px !important;
            color: #323130 !important;
            border-bottom: 1px solid #f3f2f1 !important;
            transition: background 0.2s ease !important;
        }

        .context-menu-item:hover {
            background: #f3f2f1 !important;
        }

        .context-menu-item:last-child {
            border-bottom: none !important;
        }

        .context-menu-item.delete {
            color: #d13438 !important;
        }

        .context-menu-item.delete:hover {
            background: #fde7e9 !important;
        }

        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .main-content {
                margin-right: 0;
            }
        }

        @media (max-width: 768px) {
            .top-nav {
                padding: 0 10px;
            }

            .nav-left {
                gap: 10px;
            }

            .page-controls {
                gap: 4px;
            }

            .nav-btn {
                padding: 6px 8px;
                font-size: 12px;
            }

            .page-content-area {
                padding: 20px;
            }

            .page-title-input {
                font-size: 2rem;
            }

            .web-parts-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Image Preview */
        .image-preview {
            max-width: 100%;
            max-height: 200px;
            border: 1px solid #e1dfdd;
            border-radius: 4px;
            margin-top: 10px;
        }

        /* URL Preview */
        .url-preview {
            padding: 12px;
            background: #f8f9fa;
            border: 1px solid #e1dfdd;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <!-- Top Navigation Bar -->
    <div class="top-nav">
        <div class="nav-left">
            <div class="page-controls">
                <button class="nav-btn">
                    üíæ Save and close ‚ñº
                </button>
            </div>
        </div>
        <div class="nav-right">
            <button class="nav-btn" onclick="toggleToolbox()">
                üß∞ Toolbox
            </button>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="main-layout">
        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Header/Banner Placeholder -->
            <div class="page-header-placeholder" onclick="openHeaderImageModal()">
                <button class="header-image-remove" onclick="removeHeaderImage(event)">√ó</button>
            </div>

            <!-- Page Content Area -->
            <div class="page-content-area">
                <!-- Page Title Section -->
                <div class="page-title-section">
                    <input type="text" class="page-title-input" placeholder="Add a title" value="">
                </div>

                <!-- Content Sections -->
                <div class="content-section">
                    <div class="content-block" draggable="true">
                        <div class="drag-handle">‚ãÆ‚ãÆ</div>
                        <div class="content-block-controls">
                            <button class="content-control-btn" onclick="editBlock('initial-block')">‚úèÔ∏è</button>
                            <button class="content-control-btn delete" onclick="deleteBlock('initial-block')">üóëÔ∏è</button>
                        </div>
                        <div class="content-block-content">
                            <p>Add your text here.</p>
                        </div>
                    </div>
                </div>

                <!-- Add Section Button -->
                <button class="add-section-btn" onclick="openWebPartModal()">+</button>

            </div>
        </div>

        <!-- Right Sidebar Toolbox -->
        <div class="toolbox" id="toolbox">
            <div class="toolbox-header">
                <div class="toolbox-title">Toolbox</div>
                <button class="close-toolbox" onclick="toggleToolbox()">√ó</button>
            </div>

            <div class="toolbox-section">
                <div class="section-title">Web parts</div>
                <div class="web-parts-grid">
                    <div class="web-part-option" onclick="showTextEditor()">
                        <div class="web-part-icon">AA</div>
                        <div class="web-part-label">Text</div>
                    </div>
                    <div class="web-part-option" onclick="showImageInsert()">
                        <div class="web-part-icon">üñºÔ∏è</div>
                        <div class="web-part-label">Image</div>
                    </div>
                    <div class="web-part-option" onclick="showFileMedia()">
                        <div class="web-part-icon">üìÑ</div>
                        <div class="web-part-label">File and Media</div>
                    </div>
                    <div class="web-part-option" onclick="showQuickLinks()">
                        <div class="web-part-icon">üåê</div>
                        <div class="web-part-label">Quick links</div>
                    </div>
                    <div class="web-part-option" onclick="showUrlInsert()">
                        <div class="web-part-icon">üîó</div>
                        <div class="web-part-label">Link</div>
                    </div>
                    <div class="web-part-option" onclick="showPeople()">
                        <div class="web-part-icon">üë•</div>
                        <div class="web-part-label">People</div>
                    </div>
                </div>
            </div>


        </div>
    </div>

    <!-- Web Part Selection Modal -->
    <div class="modal" id="webPartModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add a web part</h2>
                <p class="modal-subtitle">Choose a web part to add to your page</p>
            </div>
            
            <div class="modal-body">
                <div class="web-parts-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                    <div class="web-part-option" onclick="showTextEditor()">
                        <div class="web-part-icon">AA</div>
                        <div class="web-part-label">Text</div>
                    </div>
                    <div class="web-part-option" onclick="showImageInsert()">
                        <div class="web-part-icon">üñºÔ∏è</div>
                        <div class="web-part-label">Image</div>
                    </div>
                    <div class="web-part-option" onclick="showTableInsert()">
                        <div class="web-part-icon">üìä</div>
                        <div class="web-part-label">Table</div>
                    </div>
                    <div class="web-part-option" onclick="showUrlInsert()">
                        <div class="web-part-icon">üîó</div>
                        <div class="web-part-label">Link</div>
                    </div>
                    <div class="web-part-option" onclick="showFileMedia()">
                        <div class="web-part-icon">üìÑ</div>
                        <div class="web-part-label">File and Media</div>
                    </div>
                    <div class="web-part-option" onclick="showQuickLinks()">
                        <div class="web-part-icon">üåê</div>
                        <div class="web-part-label">Quick links</div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeWebPartModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Text Editor Modal -->
    <div class="modal" id="textModal">
        <div class="modal-content" style="max-width: 800px; width: 95%;">
            <div class="modal-header">
                <h2 class="modal-title">Add text</h2>
                <p class="modal-subtitle">Create rich content with formatting options</p>
            </div>
            
            <div class="modal-body">
                <div id="editor"></div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeTextModal()">Cancel</button>
                <button class="btn btn-primary" onclick="insertText()">Add</button>
            </div>
        </div>
    </div>

    <!-- Image Insert Modal -->
    <div class="modal" id="imageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add image</h2>
                <p class="modal-subtitle">Add an image to your page</p>
            </div>
            
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Image URL:</label>
                    <input type="url" class="form-input" id="imageUrl" placeholder="https://example.com/image.jpg">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Or upload from device:</label>
                    <input type="file" class="form-input" id="imageFile" accept="image/*">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Alt Text (for accessibility):</label>
                    <input type="text" class="form-input" id="imageAlt" placeholder="Description of the image">
                </div>
                
                <div id="imagePreview"></div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeImageModal()">Cancel</button>
                <button class="btn btn-primary" onclick="insertImage()">Add</button>
            </div>
        </div>
    </div>

    <!-- Table Insert Modal -->
    <div class="modal" id="tableModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add table</h2>
                <p class="modal-subtitle">Create a table with your data</p>
            </div>
            
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Number of Rows:</label>
                    <input type="number" class="form-input" id="tableRows" min="1" max="20" value="3">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Number of Columns:</label>
                    <input type="number" class="form-input" id="tableCols" min="1" max="10" value="3">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Include Header Row:</label>
                    <select class="form-input" id="tableHeaders" onchange="toggleHeaderInputs()">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                </div>
                
                <div id="headerInputs" class="form-group">
                    <label class="form-label">Header Names (comma separated):</label>
                    <input type="text" class="form-input" id="headerNames" placeholder="Name, Age, City" value="Name, Age, City">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Table Data (one row per line, comma separated):</label>
                    <textarea class="form-input form-textarea" id="tableData" placeholder="John Doe, 25, New York&#10;Jane Smith, 30, Los Angeles">John Doe, 25, New York
Jane Smith, 30, Los Angeles
Mike Johnson, 28, Chicago</textarea>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeTableModal()">Cancel</button>
                <button class="btn btn-primary" onclick="insertTable()">Add</button>
            </div>
        </div>
    </div>

    <!-- Header Image Modal -->
    <div class="modal" id="headerImageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add header image</h2>
                <p class="modal-subtitle">Choose an image for your page header</p>
            </div>
            
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Image URL:</label>
                    <input type="url" class="form-input" id="headerImageUrl" placeholder="https://example.com/header-image.jpg">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Or upload from device:</label>
                    <input type="file" class="form-input" id="headerImageFile" accept="image/*">
                </div>
                
                <div id="headerImagePreview"></div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeHeaderImageModal()">Cancel</button>
                <button class="btn btn-primary" onclick="setHeaderImage()">Set Image</button>
            </div>
        </div>
    </div>

    <!-- URL Insert Modal -->
    <div class="modal" id="urlModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add link</h2>
                <p class="modal-subtitle">Add a hyperlink to your page</p>
            </div>
            
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">URL:</label>
                    <input type="url" class="form-input" id="linkUrl" placeholder="https://example.com">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Link Text:</label>
                    <input type="text" class="form-input" id="linkText" placeholder="Click here">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Open in new tab:</label>
                    <select class="form-input" id="linkTarget">
                        <option value="_self">Same tab</option>
                        <option value="_blank">New tab</option>
                    </select>
                </div>
                
                <div id="urlPreview"></div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeUrlModal()">Cancel</button>
                <button class="btn btn-primary" onclick="insertUrl()">Add</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script>
        // Initialize Quill editor
        let quill;
        
        // Toolbox toggle
        function toggleToolbox() {
            const toolbox = document.getElementById('toolbox');
            toolbox.classList.toggle('show');
        }

        // Modal management
        function openHeaderImageModal() {
            document.getElementById('headerImageModal').classList.add('show');
        }

        function closeHeaderImageModal() {
            document.getElementById('headerImageModal').classList.remove('show');
        }

        function openWebPartModal() {
            document.getElementById('webPartModal').classList.add('show');
        }

        function closeWebPartModal() {
            document.getElementById('webPartModal').classList.remove('show');
        }

        function closeTextModal() {
            document.getElementById('textModal').classList.remove('show');
        }

        function closeImageModal() {
            document.getElementById('imageModal').classList.remove('show');
        }

        function closeTableModal() {
            document.getElementById('tableModal').classList.remove('show');
        }

        function closeUrlModal() {
            document.getElementById('urlModal').classList.remove('show');
        }

        // Web part functions
        function showTextEditor() {
            closeWebPartModal();
            document.getElementById('textModal').classList.add('show');
            
            // Initialize Quill if not already done
            if (!quill) {
                quill = new Quill('#editor', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            [{ 'header': [1, 2, 3, false] }],
                            ['bold', 'italic', 'underline'],
                            [{ 'color': [] }],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            [{ 'align': [] }],
                            ['link', 'image'],
                            ['clean']
                        ]
                    },
                    placeholder: 'Start writing your content...'
                });
            }
        }

        function insertText() {
            if (quill) {
                const content = quill.root.innerHTML;
                insertContent(content);
                closeTextModal();
            }
        }

        function showImageInsert() {
            closeWebPartModal();
            document.getElementById('imageModal').classList.add('show');
        }

        function insertImage() {
            const url = document.getElementById('imageUrl').value;
            const file = document.getElementById('imageFile').files[0];
            const alt = document.getElementById('imageAlt').value || 'Image';

            let imageHtml = '';
            
            if (url) {
                imageHtml = `<img src="${url}" alt="${alt}" style="max-width: 100%; height: auto; margin: 10px 0;">`;
            } else if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageHtml = `<img src="${e.target.result}" alt="${alt}" style="max-width: 100%; height: auto; margin: 10px 0;">`;
                    insertContent(imageHtml);
                };
                reader.readAsDataURL(file);
                closeImageModal();
                return;
            }

            if (imageHtml) {
                insertContent(imageHtml);
                closeImageModal();
            }
        }

        function showTableInsert() {
            closeWebPartModal();
            document.getElementById('tableModal').classList.add('show');
        }

        function toggleHeaderInputs() {
            const hasHeaders = document.getElementById('tableHeaders').value === 'yes';
            const headerInputs = document.getElementById('headerInputs');
            headerInputs.style.display = hasHeaders ? 'block' : 'none';
        }

        function insertTable() {
            const rows = parseInt(document.getElementById('tableRows').value);
            const cols = parseInt(document.getElementById('tableCols').value);
            const hasHeaders = document.getElementById('tableHeaders').value === 'yes';
            const headerNames = document.getElementById('headerNames').value;
            const tableData = document.getElementById('tableData').value;

            if (rows < 1 || cols < 1 || rows > 20 || cols > 10) {
                alert('Please enter valid dimensions (1-20 rows, 1-10 columns)');
                return;
            }

            // Parse headers
            let headers = [];
            if (hasHeaders && headerNames.trim()) {
                headers = headerNames.split(',').map(h => h.trim()).filter(h => h);
            }

            // Parse data rows
            let dataRows = [];
            if (tableData.trim()) {
                dataRows = tableData.split('\n').map(row => 
                    row.split(',').map(cell => cell.trim()).filter(cell => cell)
                ).filter(row => row.length > 0);
            }

            let tableHTML = '<div style="position: relative; margin: 10px 0;">';
            tableHTML += '<div class="table-controls">';
            tableHTML += '<button class="table-control-btn" onclick="addTableRow(this)">+ Row</button>';
            tableHTML += '<button class="table-control-btn" onclick="addTableColumn(this)">+ Col</button>';
            tableHTML += '<button class="table-control-btn delete" onclick="deleteTable(this)">üóëÔ∏è</button>';
            tableHTML += '</div>';
            tableHTML += '<table style="border-collapse: collapse; width: 100%; border: 2px solid #000000;">';
            
            // Add header row if requested
            if (hasHeaders) {
                tableHTML += '<thead><tr>';
                for (let i = 0; i < cols; i++) {
                    const headerText = headers[i] || `Header ${i + 1}`;
                    tableHTML += `<th style="border: 2px solid #000000; padding: 8px; background-color: #f8f9fa; font-weight: bold; text-align: left;">${headerText}</th>`;
                }
                tableHTML += '</tr></thead>';
            }
            
            // Add data rows
            tableHTML += '<tbody>';
            const maxDataRows = hasHeaders ? rows - 1 : rows;
            for (let i = 0; i < maxDataRows; i++) {
                tableHTML += '<tr>';
                for (let j = 0; j < cols; j++) {
                    const cellData = dataRows[i] && dataRows[i][j] ? dataRows[i][j] : 'Click to edit';
                    tableHTML += `<td class="editable" style="border: 2px solid #000000; padding: 8px; background-color: #fff;" onclick="editTableCell(this)">${cellData}</td>`;
                }
                tableHTML += '</tr>';
            }
            tableHTML += '</tbody></table>';
            tableHTML += '</div>';
            
            insertContent(tableHTML);
            closeTableModal();
        }

        function showUrlInsert() {
            closeWebPartModal();
            document.getElementById('urlModal').classList.add('show');
        }

        function insertUrl() {
            const url = document.getElementById('linkUrl').value;
            const text = document.getElementById('linkText').value || url;
            const target = document.getElementById('linkTarget').value;

            if (url) {
                const linkHtml = `<a href="${url}" target="${target}" style="color: #0078d4; text-decoration: none;">${text}</a>`;
                insertContent(linkHtml);
                closeUrlModal();
            }
        }

        function showFileMedia() {
            alert('File and Media web part functionality can be implemented here.');
        }

        function showQuickLinks() {
            alert('Quick Links web part functionality can be implemented here.');
        }

        function showPeople() {
            alert('People web part functionality can be implemented here.');
        }

        // Header image functions
        function setHeaderImage() {
            const url = document.getElementById('headerImageUrl').value;
            const file = document.getElementById('headerImageFile').files[0];

            let imageUrl = '';
            
            if (url) {
                imageUrl = url;
            } else if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imageUrl = e.target.result;
                    applyHeaderImage(imageUrl);
                };
                reader.readAsDataURL(file);
                closeHeaderImageModal();
                return;
            }

            if (imageUrl) {
                applyHeaderImage(imageUrl);
                closeHeaderImageModal();
            }
        }

        function applyHeaderImage(imageUrl) {
            const headerPlaceholder = document.querySelector('.page-header-placeholder');
            headerPlaceholder.style.backgroundImage = `url('${imageUrl}')`;
            headerPlaceholder.classList.add('has-image');
        }

        function removeHeaderImage(event) {
            event.stopPropagation();
            const headerPlaceholder = document.querySelector('.page-header-placeholder');
            headerPlaceholder.style.backgroundImage = '';
            headerPlaceholder.classList.remove('has-image');
        }

        // Table cell editing functions
        function editTableCell(cell) {
            // Don't edit if already editing
            if (cell.classList.contains('editing')) return;
            
            const originalText = cell.textContent.trim();
            
            // Create input element
            const input = document.createElement('input');
            input.type = 'text';
            input.value = originalText;
            input.style.width = '100%';
            input.style.height = '100%';
            input.style.border = 'none';
            input.style.outline = 'none';
            input.style.padding = '8px';
            input.style.fontSize = 'inherit';
            input.style.fontFamily = 'inherit';
            input.style.backgroundColor = '#fff';
            input.style.boxSizing = 'border-box';
            
            // Add editing class
            cell.classList.add('editing');
            cell.innerHTML = '';
            cell.appendChild(input);
            
            // Focus on input
            input.focus();
            input.select();
            
            // Handle save on Enter or blur
            function saveCell() {
                const newValue = input.value.trim();
                cell.classList.remove('editing');
                cell.innerHTML = newValue || 'Click to edit';
                cell.onclick = function() { editTableCell(this); };
                
                // Save to SharePoint list (placeholder for future integration)
                saveTableDataToSharePoint();
            }
            
            function cancelEdit() {
                cell.classList.remove('editing');
                cell.innerHTML = originalText;
                cell.onclick = function() { editTableCell(this); };
            }
            
            // Event listeners
            input.addEventListener('blur', saveCell);
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    saveCell();
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    cancelEdit();
                }
            });
        }

        function saveTableDataToSharePoint() {
            // This function will be used to save table data to SharePoint lists
            console.log('Saving table data to SharePoint...');
            // TODO: Implement SharePoint list integration
            // Example: Save table data as JSON to SharePoint list column
        }

        // Table management functions
        function addTableRow(button) {
            const table = button.parentElement.nextElementSibling;
            const tbody = table.querySelector('tbody');
            const firstRow = tbody.querySelector('tr');
            const colCount = firstRow ? firstRow.cells.length : 3;
            
            const newRow = document.createElement('tr');
            for (let i = 0; i < colCount; i++) {
                const cell = document.createElement('td');
                cell.className = 'editable';
                cell.style.cssText = 'border: 2px solid #000000; padding: 8px; background-color: #fff;';
                cell.textContent = 'Click to edit';
                cell.onclick = function() { editTableCell(this); };
                newRow.appendChild(cell);
            }
            
            tbody.appendChild(newRow);
            saveTableDataToSharePoint();
        }

        function addTableColumn(button) {
            const table = button.parentElement.nextElementSibling;
            const rows = table.querySelectorAll('tr');
            
            rows.forEach(row => {
                const cell = document.createElement('td');
                cell.className = 'editable';
                cell.style.cssText = 'border: 2px solid #000000; padding: 8px; background-color: #fff;';
                cell.textContent = 'Click to edit';
                cell.onclick = function() { editTableCell(this); };
                row.appendChild(cell);
            });
            
            saveTableDataToSharePoint();
        }

        function deleteTable(button) {
            if (confirm('Are you sure you want to delete this table?')) {
                const tableContainer = button.parentElement.parentElement;
                tableContainer.remove();
                saveTableDataToSharePoint();
            }
        }

        function deleteTableRow(row) {
            if (confirm('Are you sure you want to delete this row?')) {
                row.remove();
                saveTableDataToSharePoint();
            }
        }

        function deleteTableColumn(columnIndex) {
            if (confirm('Are you sure you want to delete this column?')) {
                const table = document.querySelector('.ql-editor table');
                const rows = table.querySelectorAll('tr');
                
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td, th');
                    if (cells[columnIndex]) {
                        cells[columnIndex].remove();
                    }
                });
                
                saveTableDataToSharePoint();
            }
        }

        function insertRowAbove(row) {
            const newRow = document.createElement('tr');
            const colCount = row.cells.length;
            
            for (let i = 0; i < colCount; i++) {
                const cell = document.createElement('td');
                cell.className = 'editable';
                cell.style.cssText = 'border: 2px solid #000000; padding: 8px; background-color: #fff;';
                cell.textContent = 'Click to edit';
                cell.onclick = function() { editTableCell(this); };
                newRow.appendChild(cell);
            }
            
            row.parentNode.insertBefore(newRow, row);
            saveTableDataToSharePoint();
        }

        function insertRowBelow(row) {
            const newRow = document.createElement('tr');
            const colCount = row.cells.length;
            
            for (let i = 0; i < colCount; i++) {
                const cell = document.createElement('td');
                cell.className = 'editable';
                cell.style.cssText = 'border: 2px solid #000000; padding: 8px; background-color: #fff;';
                cell.textContent = 'Click to edit';
                cell.onclick = function() { editTableCell(this); };
                newRow.appendChild(cell);
            }
            
            row.parentNode.insertBefore(newRow, row.nextSibling);
            saveTableDataToSharePoint();
        }

        function insertColumnLeft(columnIndex) {
            const table = document.querySelector('.ql-editor table');
            const rows = table.querySelectorAll('tr');
            
            rows.forEach(row => {
                const cell = document.createElement('td');
                cell.className = 'editable';
                cell.style.cssText = 'border: 2px solid #000000; padding: 8px; background-color: #fff;';
                cell.textContent = 'Click to edit';
                cell.onclick = function() { editTableCell(this); };
                
                const cells = row.querySelectorAll('td, th');
                if (cells[columnIndex]) {
                    row.insertBefore(cell, cells[columnIndex]);
                } else {
                    row.appendChild(cell);
                }
            });
            
            saveTableDataToSharePoint();
        }

        function insertColumnRight(columnIndex) {
            const table = document.querySelector('.ql-editor table');
            const rows = table.querySelectorAll('tr');
            
            rows.forEach(row => {
                const cell = document.createElement('td');
                cell.className = 'editable';
                cell.style.cssText = 'border: 2px solid #000000; padding: 8px; background-color: #fff;';
                cell.textContent = 'Click to edit';
                cell.onclick = function() { editTableCell(this); };
                
                const cells = row.querySelectorAll('td, th');
                if (cells[columnIndex]) {
                    row.insertBefore(cell, cells[columnIndex].nextSibling);
                } else {
                    row.appendChild(cell);
                }
            });
            
            saveTableDataToSharePoint();
        }

        // Content insertion helper
        function insertContent(html) {
            const contentSection = document.querySelector('.content-section');
            const blockId = 'block_' + Date.now();
            
            const contentBlock = document.createElement('div');
            contentBlock.className = 'content-block';
            contentBlock.id = blockId;
            contentBlock.draggable = true;
            
            contentBlock.innerHTML = `
                <div class="drag-handle">‚ãÆ‚ãÆ</div>
                <div class="content-block-controls">
                    <button class="content-control-btn" onclick="editBlock('${blockId}')">‚úèÔ∏è</button>
                    <button class="content-control-btn delete" onclick="deleteBlock('${blockId}')">üóëÔ∏è</button>
                </div>
                <div class="content-block-content">
                    ${html}
                </div>
            `;
            
            // Add drag and drop event listeners
            setupDragAndDrop(contentBlock);
            
            contentSection.appendChild(contentBlock);
        }

        // Drag and drop functionality
        function setupDragAndDrop(element) {
            element.addEventListener('dragstart', handleDragStart);
            element.addEventListener('dragend', handleDragEnd);
            element.addEventListener('dragover', handleDragOver);
            element.addEventListener('drop', handleDrop);
            element.addEventListener('dragenter', handleDragEnter);
            element.addEventListener('dragleave', handleDragLeave);
        }

        let draggedElement = null;

        function handleDragStart(e) {
            draggedElement = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.outerHTML);
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
            draggedElement = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDragEnter(e) {
            e.preventDefault();
            this.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            this.classList.remove('drag-over');
            
            if (draggedElement && draggedElement !== this) {
                const contentSection = document.querySelector('.content-section');
                const allBlocks = Array.from(contentSection.querySelectorAll('.content-block'));
                const draggedIndex = allBlocks.indexOf(draggedElement);
                const dropIndex = allBlocks.indexOf(this);
                
                if (draggedIndex < dropIndex) {
                    contentSection.insertBefore(draggedElement, this.nextSibling);
                } else {
                    contentSection.insertBefore(draggedElement, this);
                }
            }
        }

        // Content block management
        function editBlock(blockId) {
            const block = document.getElementById(blockId);
            const content = block.querySelector('.content-block-content').innerHTML;
            
            // For now, just show an alert. You can enhance this to open an editor
            alert('Edit functionality can be enhanced to open the appropriate editor based on content type.');
        }

        function deleteBlock(blockId) {
            if (confirm('Are you sure you want to delete this content block?')) {
                const block = document.getElementById(blockId);
                block.remove();
            }
        }

        // Close modals when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('show');
            }
        });

        // Image preview
        document.getElementById('imageUrl').addEventListener('input', function() {
            const url = this.value;
            const preview = document.getElementById('imagePreview');
            
            if (url) {
                preview.innerHTML = `<img src="${url}" class="image-preview" onerror="this.style.display='none'">`;
            } else {
                preview.innerHTML = '';
            }
        });

        // URL preview
        document.getElementById('linkUrl').addEventListener('input', function() {
            const url = this.value;
            const preview = document.getElementById('urlPreview');
            
            if (url) {
                preview.innerHTML = `<div class="url-preview">Preview: <a href="${url}" target="_blank">${url}</a></div>`;
            } else {
                preview.innerHTML = '';
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set up header image preview
            document.getElementById('headerImageUrl').addEventListener('input', function() {
                const url = this.value;
                const preview = document.getElementById('headerImagePreview');
                
                if (url) {
                    preview.innerHTML = `<img src="${url}" class="image-preview" onerror="this.style.display='none'">`;
                } else {
                    preview.innerHTML = '';
                }
            });

            document.getElementById('headerImageFile').addEventListener('change', function() {
                const file = this.files[0];
                const preview = document.getElementById('headerImagePreview');
                
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.innerHTML = `<img src="${e.target.result}" class="image-preview">`;
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Set up file input preview
            document.getElementById('imageFile').addEventListener('change', function() {
                const file = this.files[0];
                const preview = document.getElementById('imagePreview');
                
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.innerHTML = `<img src="${e.target.result}" class="image-preview">`;
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Set up drag and drop for initial content block
            const initialBlock = document.querySelector('.content-block');
            if (initialBlock) {
                initialBlock.id = 'initial-block';
                setupDragAndDrop(initialBlock);
            }
        });
    </script>
</body>
</html>
